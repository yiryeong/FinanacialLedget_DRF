{% extends 'base.html' %}

{% block content %}

<div class="container my-8">
    <!-- 검색, 정렬 -->
    <div class="row justify-content-between my-3">
        <div class="col-8">
            <div class="row my-16">
                <form id="expenditure_searchForm" method="get" action="{% url 'expenditure:list' %}" class="col-12">
                    <div class="row">
                        <div class="col-4">
                            <label>카테고리 검색</label>
                            <select class="form-control selected_category" name="selected_category">
                                <option value="0">카테고리 선택</option>
                                {% if category_list %}
                                    {% for category in category_list %}
                                        <option value="{{ category.id }}" {% if selected_category == category.id %} selected {% endif %} > {{ category.name }} </option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                        </div>
                        <div class="col-4">
                            <label>키워드 검색</label>
                            <input type="text" class="form-control kw" id="kw" name="kw" value="{{ kw|default_if_none:'' }}"  placeholder="키워드 검색">
                        </div>
                        <div class="col-4">
                            <label>날짜 검색</label>
                            <input type="date" class="form-control search_category" id="search_date" name="search_date" value="{{ search_date }}">
                        </div>
                    </div>
                    <br>
                    <div class="row my-6">
                        <div class="col-2">
                            <label>기간 선택</label>
                        </div>
                        <div class="col-4">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="date_scope" id="inlineRadio1" value="7" {% if date_scope == 7 %} checked="checked" {% endif %}>
                                <label class="form-check-label" for="inlineRadio1">7일</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="date_scope" id="inlineRadio2" value="30" {% if date_scope == 30 %} checked="checked" {% endif %}>
                                <label class="form-check-label" for="inlineRadio2">30일</label>
                            </div>
                        </div>
                        <div class="col-md-6 offset-md-6">
                            <button class="btn btn-outline-info" type="submit"  id="btn_search">검색</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="row justify-content-between my-3">
        <div class="col-8">
        </div>
        <div class="col-2">
            <div class="row">
                <a class="btn btn-outline-info" href="{% url 'expenditure:add_item' %}" type="button"  id="add_expenditure">내역추가</a>
            </div>
        </div>
    </div>
    <!-- 리스트 테이블 -->
    <table class="table">
        <thead>
        <tr class="thead-dark text-left">
            <th>구매날짜</th>
            <th>카테고리명</th>
            <th>상품명</th>
            <th>가격</th>
            <th>구매처</th>
            <th>메모</th>
            <th>버튼</th>
        </tr>
        </thead>
        <tbody>
        {% if expenditure_list %}
            {% for expenditure in expenditure_list %}
                <tr class="text-left">
                    <td> {{ expenditure.pay_date }} </td>
                    <td> {{ expenditure.category }} </td>
                    <td> {{ expenditure.product }} </td>
                    <td> {{ expenditure.price }} </td>
                    <td> {{ expenditure.place|default_if_none:"" }} </td>
                    <td> {{ expenditure.memo|default_if_none:"" }} </td>
                    <td>
                        <button class="btn btn-outline-info modify" type="submit">수정</button>
                        <button class="btn btn-outline-danger delete" data-uri="{% url 'expenditure:list' %}">삭제</button>
                    </td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td><span> 조회 데이터가 없습니다.</span></td>
            </tr>
        {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
{% block script %}
    <script type="text/javascript">
        $(document).ready(function() {
            $('#btn_search').on('click', function() {
                $('#kw').val($('.kw').val());
                $('#expenditure_searchForm').submit();
            });
        });
    </script>
{% endblock %}

